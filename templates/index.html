<!DOCTYPE html>
<html lang="en" xmlns="">
<head>
    <meta charset="UTF-8">
    <title>bi8a-Project</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" type="text/css"
          href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.0/semantic.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.0/semantic.min.js"></script>
    <script defer src="{{ url_for('static', filename='index.js') }}"></script>
    <script src="https://cdn.rawgit.com/mdehoog/Semantic-UI/6e6d051d47b598ebab05857545f242caf2b4b48c/dist/semantic.min.js"></script>
    <script>
        let results = {{ results | safe }};
        let email = '{{ email | safe }}';
        let ids = {{ ids_data | safe }};
        let term = '{{ term | safe }}';
    </script>

</head>

<body>
<div class="center aligned stackable ui page grid">
    <div class="sixteen wide one column">
        <!-- HEADERS -->
        <!-- Sub top of the page -->
        <h0 class="ui small header"></h0>
        <h1 class="ui teal icon header">
            <i class="search icon"></i>
            <div class="content">
                PubMed Article Searcher
                <div class="sub header">
                    "Keeping gene panels updated since 2020"
                </div>
            </div>
        </h1>
        <div class="ui divider"></div>
        <!--<h2 class="ui large header">Search Tool</h2>-->
        <!--<div class="ui divider"></div>-->
    </div>
    {% if first_time %}
        <!-- first time entering page -->
        <!-- User submitting form and summary table -->
        <div class="ui horizontal segments">
            <!--<div class="ui vertical segments">-->
            <div class="ui teal segment">
                <h2 class="ui large teal header">Search Tool</h2>
                <p><i>Fill in the parameters below as completely as possible <br> for an accurate search in the PubMed
                    articles database. </i></p>
                <br>
                <div class="ui form">
                    <form method="get" action="/">
                        <!-- Hier alle zooi voor in de form -->
                        <!-- Fields links van de UI grid form -->
                        <div class="field">
                            <div class="ui accordion">
                                <div class="title">
                                    <i class="dropdown icon"></i>
                                    Phenotype descriptors
                                </div>
                                <div class="content">
                                    <div class="ui section">
                                        <p>Please enter your phenotype descriptors here. <br>
                                            These are used in the algorithm to search for <br> articles containing these
                                            descriptors.</p>
                                    </div>
                                </div>
                                <div class="ui left icon input"><input type="text"
                                                                       placeholder="Your descriptors here"
                                                                       name="pheno_input"
                                                                       required><i
                                        class="search icon"></i>
                                </div>
                            </div>
                            <div class="field">
                                <div class="ui accordion">
                                    <div class="title">
                                        <i class="dropdown icon"></i>
                                        Article date limit
                                    </div>
                                    <div class="content">
                                        <div class="ui section">
                                            <p>This date limits the algorithm to search for <br>
                                                articles only published between the entered <br>
                                                date and present day. The date is dependant <br>
                                                on the first publication date (?). <br><br>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <div class="ui calendar" id="rangestart">
                                    <div class="ui input left icon">
                                        <i class="calendar icon"></i>
                                        <input type="text"
                                               placeholder="Fill earliest date to search from"
                                               name="calendar_input">
                                    </div>
                                </div>
                            </div>

                            <div class="inline field">
                                <div class="ui accordion">
                                    <div class="title">
                                        <i class="dropdown icon"></i>
                                        Gene symbols
                                    </div>
                                    <div class="content">
                                        <div class="ui section">
                                            <p>Enter here the gene symbols desired to be <br>
                                                searched for by the algorithm. Something <br> something genpanels.
                                                <br>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <div class="field">
                                <textarea rows="3"
                                          name="symbols_input"
                                          placeholder="PRRT2&#10;KCNMA1"
                                          required></textarea>
                                </div>
                            </div>

                            <div class="field"><label>E-mail:</label>
                                <div class="ui left icon input"><input
                                        type="text"
                                        placeholder="JohnSmith@gmail.com"
                                        name="input_mail"
                                        required><i
                                        class="mail icon"></i>
                                </div>
                            </div>

                            <input type="submit" class="ui teal submit button"
                                   value="Submit search" name="submit_button">
                            <a title="Button to start the search. Make sure all parameters are filled in correctly"><span><i
                                    class="teal question circle icon"></i></span>
                            </a>
                    </form>
                    <br><br>
                </div>
            </div>
        </div>
        </div>
    {% endif %}


{% if results %}
    <!-- User submitting form and summary table -->
    <div class="ui horizontal segments">
        <!--<div class="ui vertical segments">-->
        <div class="ui teal segment">
            <h2 class="ui large teal header">Search Tool</h2>
            <p><i>Fill in the parameters below as completely as possible <br> for an accurate search in the PubMed
                articles database. </i></p>
            <br>
            <div class="ui form">
                <form method="get" action="/">
                    <!-- Hier alle zooi voor in de form -->
                    <!-- Fields links van de UI grid form -->
                    <div class="field">
                        <div class="ui accordion">
                            <div class="title">
                                <i class="dropdown icon"></i>
                                Phenotype descriptors
                            </div>
                            <div class="content">
                                <div class="ui section">
                                    <p>Please enter your phenotype descriptors here. <br>
                                        These are used in the algorithm to search for <br> articles containing these
                                        descriptors.</p>
                                </div>
                            </div>
                        </div>
                        <div class="ui left icon input"><input type="text"
                                                               placeholder="Your descriptors here"
                                                               name="pheno_input"
                                                               required><i
                                class="search icon"></i>
                        </div>
                    </div>
                    <div class="field">

                        <div class="ui accordion">
                            <div class="title">
                                <i class="dropdown icon"></i>
                                Article date limit
                            </div>
                            <div class="content">
                                <div class="ui section">
                                    <p>This date limits the algorithm to search for <br>
                                        articles only published between the entered <br>
                                        date and present day. The date is dependant <br>
                                        on the first publication date (?). <br><br>
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="ui calendar" id="rangestart">
                            <div class="ui input left icon">
                                <i class="calendar icon"></i>
                                <input type="text"
                                       placeholder="Fill earliest date to search from"
                                       name="calendar_input">
                            </div>
                        </div>
                    </div>

                    <div class="inline field">
                        <div class="ui accordion">
                            <div class="title">
                                <i class="dropdown icon"></i>
                                Gene symbols
                            </div>
                            <div class="content">
                                <div class="ui section">
                                    <p>Enter here the gene symbols desired to be <br>
                                        searched for by the algorithm. Something <br> something genpanels.
                                        <br>
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="field">
                                <textarea rows="3"
                                          name="symbols_input"
                                          placeholder="PRRT2&#10;KCNMA1"
                                          required></textarea>
                        </div>
                    </div>

                </form>
                <br>

                <!-- Fluid dropdown -->
                <div class="inline field">
                    <div class="ui accordion">
                        <div class="title">
                            <i class="dropdown icon"></i>
                            Select algorithm focus
                        </div>
                        <div class="content">
                            <div class="ui section">
                                <p>Selecting one or several of the options below will <br>
                                    urge the tool to look for deeper purpose in the <br>
                                    selected article sections.
                                    <br>
                                </p>
                            </div>
                        </div>
                    </div>
                    <select multiple=""
                            class="label ui selection fluid dropdown"
                            name="focus_input"
                            id="multiple_select">
                        <option value="Title" selected>Title</option>
                        <option value="Sentence" selected>Sentence</option>
                        <option value="Abstract">Abstract</option>
                        <option value="Multiple Abstracts">Multiple
                            Abstracts
                        </option>
                    </select>
                </div>
                <br>

                <div class="field"><label>E-mail:</label>
                    <div class="ui left icon input"><input
                            type="text"
                            placeholder="Email"
                            name="input_mail"
                            required><i
                            class="mail icon"></i>
                    </div>
                </div>


                <div class="field"><label>Job Title:</label>
                    <div class="ui left icon input"><input
                            type="text"
                            placeholder="Job title"
                            id="job-title"><i
                            class=" clipboard icon"
                    ></i>
                    </div>
                </div>
                <div>
                    <div class="ui checkbox">
                        <input type="checkbox" checked="" id="notify">
                        <label>Notify me by e-mail when my results are
                            ready!</label>
                        <br>
                    </div>
                </div>

                <input type="submit" class="ui teal submit button"
                       value="Submit search" name="submit_button">
                <a title="Button to start the search. Make sure all parameters are filled in correctly"><span><i
                        class="teal question circle icon"></i></span>
                </a>

            </div>
            {#            {% endif %}#}
            <br>
            <button class="ui teal button test-button">Algorith</button>
            <a title="Button for algorithm testing purposes? (WIP)"><span><i
                    class="teal question circle icon"></i></span>
            </a>
        </div>

        <!-- Summary Tabel -->

        <div class="ui teal segment">
            <h3 class="ui large teal header">Search results summary</h3>
            <p><i>This section shows the most recent search data, and allows the <br> user to download this data.</i>
            </p>
            <br>
            {% if results %}
                <a href="{{ url_for('download', results=[results], email=email) }}">
                    <button class="ui teal upload button" id="download-button">
                        Download data
                    </button>
                </a>
                <a title="Button to start the search. Make sure all parameters are filled in correctly"><span><i class="teal question circle icon"></i></span></a>
            {% endif %}
            <br>
            <table class="ui sortable large celled table ">
                <thead>
                <tr>
                    <th> Query</th>
                    <th> Symbols Searched</th>
                    <th> # of articles found</th>
                </tr>
                </thead>
                {% if results %}
                    <tbody>
                    <!-- Dit moet nog aangepast worden naar dynamisch in te vullen data vanuit de zoekopdracht -->
                    {% for result in results %}
                        <tr>
                            <td data-label="Query">{{ result["search_word"] }}</td>
                            <td data-label="Symbols">{{ result["searched_gene_symbols"] }}</td>
                            <td data-label="# of articles found"><a
                                    target="_blank"
                                    href="{{ result["link"] }}">{{ result["amount_hits"] }}
                            </a>
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                {% endif %}
            </table>
        </div>
    </div>

    <!-- Big results table -->
    <div class="sixteen wide one column">
        <div class="ui divider">
            <br><br>
            <div class="left aligned ui segment">
                <h4 class="ui large teal header">Full Search Results</h4>
{#                Moet nog even uitzoeken hoe ik dit netter maak zodat het niet zo schreeuwend op de website staat. #}
                <p><i>This section shows the full results relevant to the latest search query  (Dit is WIP)</i></p>
                <table class="ui celled table">
                    <thead>
                    <tr>
                        <th> Query</th>
                        <th> Gene Symbol</th>
                        <th> Keywords</th>
                        <th> Article Title</th>
                        <th> Publication Date</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td data-label="Query">FOX2P</td>
                        <td data-label="Gene Symbols">Some Symbol</td>
                        <td data-label="Keywords">4</td>
                        <td data-label="Article Title">Insert a title</td>
                        <td data-label="Publication Date">19-4-2014</td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <br><br><br><br>
        </div>
    </div>
{% endif %}
</body>

<script language='javascript'>
    $(document).ready(function () {
        $('.ui.accordion').accordion({
            collapsible: true, active: false, clearStyle: true
        });

    });
</script>

</html>

